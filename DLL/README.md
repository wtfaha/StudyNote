# DLL(動態連結程式庫)
*****
當您在其中一個 Windows 作業系統上執行的程式，大部分的程式功能可能會提供 Dll。
	例如，某些程式可能包含許多不同的模組，而是包含程式的每個模組，並將其分散在 Dll 中。    

使用 Dll 有助於促進程式碼模組化、 程式碼重複使用、 記憶體使用更有效率，此選項，減少磁碟空間。
	因此，作業系統及程式載入速度、 執行速度加快，並且使用剩餘的磁碟空間較少的電腦上。

當程式使用 DLL 時，稱為相依性的問題可能會造成程式不執行。
當程式使用 DLL 時，則會建立相依性。
如果另一個程式將會進行覆寫，並會中斷此相依性，則原始的程式可能無法成功執行。

+ ### DLL 是什麼？
	+ DLL 是含有程式碼和可由多個程式在同一時間使用的資料的程式庫。這有助於提升重複使用程式碼和記憶體使用更有效率。   
		例如，在 Windows 作業系統中，Comdlg32 DLL 會執行通用對話方塊相關的函式。因此，每個程式可以使用這個 DLL 來實作 [開啟] 對話方塊中所包含的功能。   
	+ 藉由使用 DLL，程式可以是模組化成個別的元件。模組是分開的因為程式的載入時間速度更快，並要求該功能時，將只載入模組。    
		例如，某個會計程式可能以模組的方式做銷售。在執行階段可以每個模組載入至主要的程式，如果已安裝該模組。   
	+ 此外，更新也將套用至每個模組，而不會影響程式的其他部分的工作變得更容易。這些變更隔離至 DLL 時，您可以套用更新，而不必建立或重新安裝整個程式。    
		例如，您可能有薪資程式，但稅率每一年都會變更。    

+ ### DLL 的優點
	下列清單描述部分的程式使用 DLL 時所提供的優點︰   
	+ 使用較少的資源   
		當多個程式使用相同的媒體櫃的函式時，DLL 就可以減少磁碟上，並在實體記憶體中載入的程式碼重複。    
		這可能會大幅影響不只是程式在前景執行，但在 Windows 作業系統執行其他程式的效能。    
	+ 將升級模組化架構   
		DLL 中，可以幫助提升開發模組化的程式。   
		這可協助您開發大型需要多個語言版本的程式或某個程式需要 [模組化架構。   
		模組化的範例是程式的會計程式，有許多可以在執行階段以動態方式載入的模組。   
	+ Eases 部署和安裝   
		當 DLL 內的函式需要更新或修正程式時，此 DLL 的安裝與部署不需要重新連結使用的 DLL 的程式。   
		此外，如果多個程式使用同一個 DLL，多個程式所有有志更新或修正程式。   
		當您使用協力廠商的 DLL，定期更新或修正時，可能更頻繁地發生這個問題。   
			
+ ### DLL 相依性   
	當程式或 DLL 中另一個 DLL 使用 DLL 函式時，會建立相依性。因此，該程式不再是獨立，而且程式可能會遇到問題，如果相依性已中斷。例如，如果發生其中一項動作，可能無法執行程式︰   
		相依的 DLL 會升級到新的版本。   
		相依的 DLL 被固定的。   
		相依的 DLL 會覆寫較早的版本。   
		相依的 DLL 會從電腦移除。   
	這些動作通常稱為 DLL 衝突。如果不強制的回溯相容性，程式可能無法成功執行。   

	下列清單說明採用了在 Microsoft Windows 2000 和更新 Windows 作業系統，有助於降低相依性問題的變更︰   
	+ Windows 檔案保護   
		在 [Windows 檔案保護，作業系統會防止系統 Dll 從要更新或刪除由未經授權的代理程式 」。   
		因此，當程式安裝嘗試移除或更新的定義是系統 DLL 的 DLL 時，Windows 檔案保護會尋找有效的數位簽章。   
	+ 私用的 Dll   
		私用 Dll 可讓您隔離來自共用的 dll 私用 dll 所做的變更的程式會使用版本特定的資訊或空.local 檔來強制執行的程式所使用的 dll 版本。   
		若要使用私用的 Dll，您可以在程式的根資料夾中找出您的 Dll。   
		然後，新的程式，請將版本專屬資訊加入至 DLL。舊的程式中使用空白.local 檔。   
		每一種方法會告知作業系統使用私用程式的根資料夾中的 Dll。   
		
+ ### DLL 的疑難排解工具
	數種工具可協助您疑難排解 DLL 問題。下列的工具是一些這些工具。   
	+ 相依性查核器   
		相依性查核器工具可以遞迴地掃描所有相依的 Dll 所使用的程式。當您開啟程式中相依性查核器時，相依性查核器會執行下列檢查︰   
			相依性查核器會檢查遺失的 Dll。   
			相依性查核器會檢查程式檔案或不正確的 Dll。   
			相依性查核器會檢查的函式匯入和匯出函式符合的項目。   
			相依性查核器會檢查有循環相依性錯誤。   
			相依性查核器會檢查不正確，因為模組是不同的作業系統的模組。   
		藉由使用相依性查核器，您可以記錄所有的程式使用的 Dll。這可能有助於防止，並修正可能是發生在未來的 DLL 問題。當您在安裝 Microsoft Visual Studio 6.0 時，相依性查核器位於下列目錄︰   
			磁碟機\Program Files\Microsoft 視覺化的 Studio\Common\Tools   
			
+ ### DLL 通用問題 「 規劃求解 」   
	DLL 通用問題 「 規劃求解 」 (DUPS) 工具用來稽核、 比較文件，和顯示 DLL 的資訊。下列清單說明組成 「 DUPS 」 工具的公用程式︰   
		Dlister.exe   
			這個公用程式會列舉電腦上的所有 Dll，並記錄到文字檔案或資料庫檔案的資訊。   
		Dcomp.exe    
			這個公用程式會比較兩個文字檔案中所列的 Dll，並且會產生一個包含差異的第三個文字檔案。   
		Dtxt2DB.exe    
			這個公用程式會載入使用 Dlister.exe 公用程式，並在 dllHell 資料庫的 「 Dcomp.exe 」 公用程式所建立的文字檔。   
		DlgDtxt2DB.exe   
	這個公用程式會提供圖形化使用者介面 (GUI) 版本的 Dtxt2DB.exe 公用程式。   
	如需有關 「 DUPS 」 工具的詳細資訊，請按一下下面的文件編號，檢視 「 Microsoft 知識庫 」 中的文件︰   
		247957使用 DUPS.exe 來解決 DLL 相容性問題   
		
+ ### DLL 協助資料庫   
	http://support.microsoft.com/dllhelp/   

